- if @current_user
  
  
  - sosol_boards = @current_user.boards.ranked

  -# need list of community board ids
  - community_ids = @current_user.boards.collect{ |b| b.community_id }
  - community_ids.uniq!
  - community_ids.compact!

  - if sosol_boards.length > 0 || community_ids.length > 0


        
    - current_board_id  = nil
    
    - if @current_board
      - current_board_id = @current_board.id
    - elsif false && @current_publication && @current_publication.owner_type == "Board"
      - current_board_id = @current_publication.owner.id
    

    
 
    %li{:onclick=>"showBoardDialog(event)",  :id=>"board_menu", :class=>"editor_menu"}
      = "Boards"
  
    %div{:class => "editor_nav", :id=>"board_list"}
      %ul
        - sosol_boards.each do |sb|
          %li
            = link_to sb.friendly_name, :controller => "user", :action => "dashboard", :dashboard_type => "board", :board_id => sb.id
        
    
        
        - community_ids.each do |next_id|
         
          - community_boards = @current_user.boards.ranked_by_community_id(next_id)
          - current_name = Community.find(next_id).friendly_name
          

          %li
            = current_name    
          - community_boards.each do |cb|
            %li
              = link_to cb.friendly_name, :controller => "user", :action => "dashboard", :dashboard_type => "board", :board_id => cb.id

:javascript
  
  //------------------------------------------------------------
  //  Drop down menu when board list is clicked
  //------------------------------------------------------------
  function showBoardDialog( _e ) {
  
    //------------------------------------------------------------
    //  Add to the dom
    //------------------------------------------------------------
    var board_list = jQuery('#board_list');
    var board_menu = jQuery('#board_menu');
    jQuery('body').append( board_list );
    
    //------------------------------------------------------------
    //  Display switch
    //------------------------------------------------------------
    if ( board_list.css('display') == 'block' ) {
      board_list.css('display', 'none');
    }
    else {
      board_list.css('display', 'block');
    }
    
    //------------------------------------------------------------
    //  Position the board list
    //------------------------------------------------------------
    positionBoardList();
    jQuery( window ).resize( function() {
        positionBoardList();
    });
  }
  
  //------------------------------------------------------------
  //  Position the board list
  //------------------------------------------------------------
  function positionBoardList() {
    var board_list = jQuery('#board_list');
    var board_menu = jQuery('#board_menu');
    board_list.css({ 
      position: 'absolute', 
      zIndex: '9999'}
    );
    var left_pos = board_menu.offset().left + board_menu.width() - board_list.width() ;
    var top_pos = board_menu.offset().top + board_menu.width() ;
    board_list.css('top', top_pos + 'px' );
    board_list.css('left', left_pos + 'px' );
  }
  
  //------------------------------------------------------------
  //  Hide the board list if outside board list is clicked
  //------------------------------------------------------------
  jQuery( document ).click( function( _e ) {
    var clicked = _e.target;
    if ( clicked.id != 'board_menu' ) { 
      if ( jQuery('#board_list') )  {
        jQuery('#board_list').css( 'display', 'none' );
      }
    }
  });